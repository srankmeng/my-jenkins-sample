pipeline {
    agent any
    // parameters {
    //     string(name: 'IMAGE_TAG', defaultValue: '', description: 'docker image tag version')
    // }

    stages {
        stage('Deploy application') {
            steps {
                script {
                      buildNumber = Jenkins.instance.getItem('demo_pipeline').lastSuccessfulBuild.number
                 }
                echo '${buildNumber}'
                sh 'docker rm -f json-server || true'
                sh 'docker run -p 3000:3000 --name json-server -d srank123/json-server:${buildNumber}'       
            }
        }
    }
    post {
        always {
            echo 'deploy done'
        }
    }
}
